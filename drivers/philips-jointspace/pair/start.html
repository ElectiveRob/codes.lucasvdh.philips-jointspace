<script>

    Homey.on('error', function (errortype, callback) {
        if (errortype == 'error') {
            Homey.alert(__('pair.start.error'), 'error');
            Homey.done();
        }
        if (errortype == 'nosettings') {
            Homey.alert(__('pair.start.nosettings'), 'error');
            Homey.done();
        }
    });

    function saveSettings() {
        console.log('Saving settings...');

        // variables
        var inputIPAddress = document.getElementById('ipAddress').value;
        var inputDeviceNr = document.getElementById('deviceNr').value;
        var inputDeviceName = document.getElementById('deviceName').value;

        // If required values are filled in
        // FIXME: should check if this is a real IPv4 address

        if (inputIPAddress != '') {

            // Build data array
            var data = {
                ipAddress: inputIPAddress,
                apiVersion: inputDeviceNr,
                deviceName: inputDeviceName
            };

            console.log('Saving device data', data);

            // Continue to back-end, pass along data
            Homey.emit('start_pair', data);

        } else {

            // Give error, required values
            Homey.alert(__('pair.start.required'), 'error');
            // Homey.done() closes the pairing window
            Homey.done();

        }

    }

</script>

<p data-i18n="pair.start.intro">Enter IP address and name</p>

<style>
    .pairSettings {
        font-size: 16px;
        border: none;
        width: 100%;
    }

    input {
        font-size: 16px;
    }

</style>

<table class="pairSettings">
    <tr>
        <td data-i18n="pair.start.ipAddress">IP</td>
        <td><input id="ipAddress" type="text" value="192.168.1.10" placeholder=""/></td>
    </tr>
    <tr>
        <td data-i18n="pair.start.apiVersion">API version</td>
        <td>
            <select id="deviceNr">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6" selected>6</option>
            </select>
        </td>
    </tr>
    <tr>
        <td data-i18n="pair.start.deviceName">Name</td>
        <td><input id="deviceName" type="text" value="Philips TV" placeholder=""/></td>
    </tr>
</table>

<p>
    &nbsp;
</p>

<fieldset>
    <button class="button" data-i18n="pair.start.saveSettings" onclick="saveSettings()">Save</button>
</fieldset>