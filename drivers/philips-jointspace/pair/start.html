<link href="../assets/pairing.css" rel="stylesheet">

<p data-i18n="pair.start.intro"></p>

<table class="pairSettings">
    <tr>
        <th data-i18n="pair.start.deviceName">Name</th>
    </tr>
    <tr>
        <td style="padding-bottom: 1.5rem;"><input id="deviceName" type="text" value="Philips TV" placeholder=""/></td>
    </tr>
    <tr>
        <th data-i18n="pair.start.ipAddress">IP address</th>
    </tr>
    <tr>
        <td><input id="ipAddress" type="text" value="192.168.1.10" placeholder=""/></td>
    </tr>
    <tr>
        <td class="info" data-i18n="pair.start.ipAddressDescription"></td>
    </tr>
    <tr>
        <th data-i18n="pair.start.constructionYear">Model construction year</th>
    </tr>
    <tr>
        <td>
            <select id="apiVersion" class="form-control">
                <option value="1">voor 2016</option>
                <option value="6" selected>2016 of later</option>
            </select>
        </td>
    </tr>
    <tr>
        <td class="info" data-i18n="pair.start.constructionYearDescription"></td>
    </tr>
</table>

<a class="btn btn-success btn-block btn-lg" data-i18n="pair.start.saveSettings" onclick="saveSettings()">Save</a>

<script>
    Homey.on('error', function (errortype, callback) {
        if (errortype === 'error') {
            Homey.alert(__('pair.start.error'), 'error');
            Homey.done();
        }
        if (errortype === 'host_unreachable') {
            Homey.alert(__('pair.start.hostUnreachable'), 'error');
        }
    });

    function saveSettings() {
        console.log('Saving settings...');

        // variables
        var inputIPAddress = document.getElementById('ipAddress').value;
        var inputApiVersion = document.getElementById('apiVersion').value;
        var inputDeviceName = document.getElementById('deviceName').value;

        // If required values are filled in
        if (inputIPAddress != '') {
            // Build data array
            var data = {
                ipAddress: inputIPAddress,
                apiVersion: inputApiVersion,
                deviceName: inputDeviceName
            };

            console.log('Saving device data', data);

            // Continue to back-end, pass along data
            Homey.emit('start_pair', data);
        }
    }

</script>